/*! cheqroom-core 2019-11-25 */
!function(a){"function"==typeof define&&define.amd?define(["jquery","moment"],a):a($,moment)}(function(a,b){var c,d,e,f,g,h,i,j,k,l;return c=function(a){a.fn.ajaxQueue=function(){var b=(new a.Deferred).resolve();return function(a,c){if("function"!=typeof a)throw"must be a function";return b=b.then(a,c||a)}}}(a),d=function(a,b){var c=2048;a.ajaxSetup({cache:!1});var d={};return d.NetworkNotConnected=function(a,b){this.code=999,this.message=a||"Connection interrupted",this.opt=b},d.NetworkNotConnected.prototype=new Error,d.NetworkTimeout=function(a,b){this.code=408,this.message=a||"Could not reach the server in time",this.opt=b},d.NetworkTimeout.prototype=new Error,d.ApiError=function(a,b){this.code=500,this.message=a||"Something went wrong on the server",this.opt=b},d.ApiError.prototype=new Error,d.ApiNotFound=function(a,b){this.code=404,this.message=a||"Could not find what you're looking for",this.opt=b},d.ApiNotFound.prototype=new Error,d.ApiBadRequest=function(a,b){this.code=400,this.message=a||"The server did not understand your request",this.opt=b},d.ApiBadRequest.prototype=new Error,d.ApiUnauthorized=function(a,b){this.code=401,this.message=a||"Your session has expired",this.opt=b},d.ApiUnauthorized.prototype=new Error,d.ApiForbidden=function(a,b){this.code=403,this.message=a||"You don't have sufficient rights",this.opt=b},d.ApiForbidden.prototype=new Error,d.ApiUnprocessableEntity=function(a,b){this.code=422,this.message=a||"Some data is invalid",this.opt=b},d.ApiUnprocessableEntity.prototype=new Error,d.ApiSubscriptionLimit=function(a,b){this.code=422,this.message=a||"You have reached your subscription limit",this.opt=b},d.ApiSubscriptionLimit.prototype=new Error,d.ApiPaymentRequired=function(a,b){this.code=402,this.message=a||"Your subscription has expired",this.opt=b},d.ApiPaymentRequired.prototype=new Error,d.ApiServerCapicity=function(a,b){this.code=503,this.message=a||"Back-end server is at capacity",this.opt=b},d.ApiServerCapicity.prototype=new Error,d.ApiAjax=function(a){a=a||{},this.timeOut=a.timeOut||1e4,this.responseInTz=!0},d.ApiAjax.prototype.get=function(a,b){return this._getAjax(a,b)},d.ApiAjax.prototype.post=function(a,b,c){return this._postAjax(a,b,c)},d.ApiAjax.prototype._handleAjaxSuccess=function(a,b,c){return this.responseInTz&&(b=this._fixDates(b)),a.resolve(b)},d.ApiAjax.prototype._handleAjaxError=function(a,b,c,e,f){if("abort"!=c){var g="";if("timeout"===e)a.reject(new d.NetworkTimeout(g,f));else switch(b&&(b.statusText&&b.statusText.indexOf("Notify user:")>-1&&(g=b.statusText.slice(b.statusText.indexOf("Notify user:")+13)),422==b.status&&b.responseText&&b.responseText.match(/HTTPError: \(.+\)/g).length>0&&(f={detail:b.responseText.match(/HTTPError: \(.+\)/g)[0]})),b.status){case 400:a.reject(new d.ApiBadRequest(g,f));break;case 401:a.reject(new d.ApiUnauthorized(g,f));break;case 402:a.reject(new d.ApiPaymentRequired(g,f));break;case 403:a.reject(new d.ApiForbidden(g,f));break;case 404:a.reject(new d.ApiNotFound(g,f));break;case 408:a.reject(new d.NetworkTimeout(g,f));break;case 422:a.reject(g&&g.indexOf("limit")>=0&&g.indexOf("reach")>=0?new d.ApiSubscriptionLimit(g,f):new d.ApiUnprocessableEntity(g,f));break;case 503:a.reject(new d.ApiServerCapicity(g,f));break;case 500:default:a.reject(new d.ApiError(g,f))}}},d.ApiAjax.prototype._postAjax=function(b,c,d,e){var f=a.Deferred(),g=this,h=a.ajax({type:"POST",url:b,data:JSON.stringify(this._prepareDict(c)),contentType:"application/json; charset=utf-8",timeout:d||this.timeOut,success:function(a){return g._handleAjaxSuccess(f,a,e)},error:function(a,b,c){return g._handleAjaxError(f,a,b,c,e)}}),i=f.promise();return i.abort=function(){h.abort()},i},d.ApiAjax.prototype._getAjax=function(b,c,d){var e=a.Deferred(),f=this,g=a.ajax({url:b,timeout:c||this.timeOut,success:function(a){return f._handleAjaxSuccess(e,a,d)},error:function(a,b,c){return f._handleAjaxError(e,a,b,c,d)}}),h=e.promise();return h.abort=function(){g.abort()},h},d.ApiAjax.prototype._prepareDict=function(c){return c?(a.each(c,function(a,d){b.isMoment(d)&&(c[a]=d.toJSONDate())}),c):{}},d.ApiAjax.prototype._fixDates=function(c){if("string"==typeof c||c instanceof String){if(c.endsWith("+00:00")){var d=c.length;if(25==d)return b(c.substring(0,d-6));if(32==d)return b(c.substring(0,d-6).split(".")[0])}}else if(c instanceof Object||a.isArray(c)){var e=this;a.each(c,function(a,b){c[a]=e._fixDates(b)})}return c},d.ApiUser=function(a){a=a||{},this.userId=a.userId||"",this.userEmail=a.userEmail||"",this.userToken=a.userToken||"",this.tokenType=a.tokenType||""},d.ApiUser.prototype.fromStorage=function(){this.userId=window.localStorage.getItem("userId")||"",this.userEmail=window.localStorage.getItem("userEmail")||"",this.userToken=window.localStorage.getItem("userToken")||"",this.tokenType=window.localStorage.getItem("tokenType")||""},d.ApiUser.prototype.toStorage=function(){window.localStorage.setItem("userId",this.userId),window.localStorage.setItem("userEmail",this.userEmail),window.localStorage.setItem("userToken",this.userToken),window.localStorage.setItem("tokenType",this.tokenType)},d.ApiUser.prototype.removeFromStorage=function(){window.localStorage.removeItem("userId"),window.localStorage.removeItem("userEmail"),window.localStorage.removeItem("userToken"),window.localStorage.removeItem("tokenType")},d.ApiUser.prototype.clearToken=function(){window.localStorage.setItem("userToken",null),window.localStorage.setItem("tokenType",null)},d.ApiUser.prototype.isValid=function(){return null!=this.userId&&this.userId.length>0&&null!=this.userToken&&this.userToken.length>0},d.ApiUser.prototype._reset=function(){this.userId="",this.userToken="",this.tokenType="",this.userEmail=""},d.ApiAuth=function(a){a=a||{},this.urlAuth=a.urlAuth||"",this.ajax=a.ajax,this.version=a.version,this.platform=a.platform,this.device=a.device,this.allowAccountOwner=void 0!==a.allowAccountOwner?a.allowAccountOwner:!0},d.ApiAuth.prototype.authenticate=function(b,c){var d=this,e={user:b,password:c,_v:this.version};this.platform&&(e.platform=this.platform),this.device&&(e.device=this.device);var f=a.Deferred();return this.ajax.post(this.urlAuth,e,3e4).done(function(a){"OK"==a.status&&(-1!=["expired","cancelled_expired","archived"].indexOf(a.subscription)?d.allowAccountOwner:!0)?f.resolve(a.data):f.reject(a)}).fail(function(a){f.reject(a)}),f.promise()},d.ApiAuthV2=d.ApiAuth,d.ApiAnonymous=function(a){a=a||{},this.ajax=a.ajax,this.urlApi=a.urlApi||"",this.version=a.version},d.ApiAnonymous.prototype.call=function(b,d,e,f){this.version&&(d=d||{},d._v=this.version);var g=this.urlApi+"/"+b,h=g+"?"+a.param(this.ajax._prepareDict(d));return f||h.length>=c?this.ajax.post(g,d,e):this.ajax.get(h,e)},d.ApiAnonymous.prototype.longCall=function(a,b,c){return this.call(a,b,6e4,c)},d.ApiDataSource=function(a){a=a||{},this.collection=a.collection||"",this.urlApi=a.urlApi||"",this.user=a.user,this.ajax=a.ajax,this.version=a.version},d.ApiDataSource.prototype.exists=function(b,c){var e="exists",f=a.Deferred(),g=this.getBaseUrl()+b,h=this.getParams(c);return a.isEmptyObject(h)||(g+="?"+this.getParams(h)),this._ajaxGet(e,g).done(function(a){f.resolve(a)}).fail(function(a){a instanceof d.ApiNotFound?f.resolve(null):f.reject(a)}),f.promise()},d.ApiDataSource.prototype.get=function(b,c){var d="get",e=this.getBaseUrl()+b,f=this.getParamsDict(c);return a.isEmptyObject(f)||(e+="?"+this.getParams(f)),this._ajaxGet(d,e)},d.ApiDataSource.prototype.getIgnore404=function(b,c){var e=a.Deferred();return this.get(b,c).done(function(a){e.resolve(a)}).fail(function(a){a instanceof d.ApiNotFound?e.resolve(null):e.reject(a)}),e.promise()},d.ApiDataSource.prototype.getMultiple=function(b,c){var d="getMultiple",e=100,f=b.map(function(a,c){return c%e===0?b.slice(c,c+e):null}).filter(function(a){return a}),g=this,h=[],i=new a.fn.ajaxQueue,j=a.Deferred();return a.each(f,function(b,e){var f=g.getBaseUrl()+e.join(","),j=g.getParamsDict(c);a.isEmptyObject(j)||(f+="?"+g.getParams(j)),i(function(){return g._ajaxGet(d,f).then(function(b){b=a.isArray(b)?b:[b],h=h.concat(b)})})}),i(function(){return j.resolve(h)}),j},d.ApiDataSource.prototype["delete"]=function(a){var b="delete",c=this.getBaseUrl()+a+"/delete";return this._ajaxGet(b,c)},d.ApiDataSource.prototype.deleteMultiple=function(a,b){var d="deleteMultiple",e=this.getBaseUrl()+"delete",f={pk:a},g=e+"?"+this.getParams(f);return b||g.length>=c?this._ajaxPost(d,e,f):this._ajaxGet(d,g)},d.ApiDataSource.prototype.update=function(b,d,e,f,g){var h="update",i=this.getBaseUrl()+b+"/update",j=a.extend({},d);null!=e&&e.length>0&&(j._fields=a.isArray(e)?e.join(","):e);var k=i+"?"+this.getParams(j);return g||k.length>=c?this._ajaxPost(h,i,j,f):this._ajaxGet(h,k,f)},d.ApiDataSource.prototype.create=function(b,d,e,f){var g="create",h=this.getBaseUrl()+"create",i=a.extend({},b);null!=d&&d.length>0&&(i._fields=a.isArray(d)?d.join(","):d);var j=h+"?"+this.getParams(i);return f||j.length>=c?this._ajaxPost(g,h,i,e):this._ajaxGet(g,j,e)},d.ApiDataSource.prototype.createMultiple=function(b,c){var d=a.Deferred(),e=this,f=b.slice(0),g=[],h=function(a){if(a.length>0){var b=a.pop();e.create(b,c).done(function(b){return g.push(b._id),h(a)}).fail(function(a){d.reject(a)})}else d.resolve(g)};return h(f),d.promise()},d.ApiDataSource.prototype.list=function(b,c,d,e,f){b=b||"";var g="list."+b,h=this.getBaseUrl();null!=b&&b.length>0&&(h+="list/"+b+"/");var i=this.getParamsDict(c,d,e,f);return a.isEmptyObject(i)||(h+="?"+this.getParams(i)),this._ajaxGet(g,h)},d.ApiDataSource.prototype.search=function(a,b,c,d,e,f){var g="search",h=this.searchUrl(a,b,c,d,e,f);return this._ajaxGet(g,h)},d.ApiDataSource.prototype.searchUrl=function(b,c,d,e,f,g){var h=this.getBaseUrl()+"search",i=a.extend(this.getParamsDict(c,d,e,f),b);return null!=g&&g.length>0&&(i.mimeType=g),h+="?"+this.getParams(i)},d.ApiDataSource.prototype["export"]=function(a,b,c,d,e,f){var g="export",h=this.exportUrl(a,b,c,d,e,f);return this._ajaxGet(g,h)},d.ApiDataSource.prototype.exportUrl=function(b,c,d,e,f,g){var h=this.getBaseUrl()+"call/export",i=a.extend(this.getParamsDict(c,d,e,f),b);return null!=g&&g.length>0&&(i.mimeType=g),h+="?"+this.getParams(i)},d.ApiDataSource.prototype.call=function(b,d,e,f,g,h){var i="call."+d,j=null!=b&&b.length>0?this.getBaseUrl()+b+"/call/"+d:this.getBaseUrl()+"call/"+d,k=a.extend({},this.getParamsDict(f,null,null,null),e),l=j+"?"+this.getParams(k);return h||l.length>=c?this._ajaxPost(i,j,k,g):this._ajaxGet(i,l,g)},d.ApiDataSource.prototype.callMultiple=function(b,d,e,f,g,h){var i="call."+d,j=this.getBaseUrl()+b.join(",")+"/call/"+d,k=a.extend({},this.getParamsDict(f,null,null,null),e),l=j+"?"+this.getParams(k);return h||l.length>=c?this._ajaxPost(i,j,k,g):this._ajaxGet(i,l,g)},d.ApiDataSource.prototype.longCall=function(a,b,c,d,e){return this.call(a,b,c,d,6e4,e)},d.ApiDataSource.prototype.getBaseUrl=function(){var a=null!=this.user.tokenType&&this.user.tokenType.length>0?this.user.tokenType:"null";return this.urlApi+"/"+this.user.userId+"/"+this.user.userToken+"/"+a+"/"+this.collection+"/"},d.ApiDataSource.prototype.getParams=function(b){return a.param(this.ajax._prepareDict(b))},d.ApiDataSource.prototype.getParamsDict=function(b,c,d,e){var f={};return b&&(f._fields=a.isArray(b)?b.join(","):b.replace(/\s/g,"")),c&&(f._limit=c),d&&(f._skip=d),e&&(f._sort=e),this.version&&(f._v=this.version),f},d.ApiDataSource.prototype._ajaxGet=function(a,b,c){return this.ajax.get(b,c,{coll:this.collection,cmd:a})},d.ApiDataSource.prototype._ajaxPost=function(a,b,c,d){return this.ajax.post(b,c,d,{coll:this.collection,cmd:a})},d}(a,b),e={amazonBucket:"app"},f=function(a){return{isValidEmail:function(a){var b=a.match(/^([\w-\+']+(?:\.[\w-\+']+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,}(?:\.[a-z]{2})?)$/i);return null!=b&&b.length>0},isFreeEmail:function(a){var b=a.match(/^([\w-\+]+(?:\.[\w-\+]+)*)@(?!gmail\.com)(?!yahoo\.com)(?!hotmail\.com)(?!163\.com)(?!qq\.com)((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,}(?:\.[a-z]{2})?)$/i);return null==b},isValidPhone:function(a){if(a=a.replace(/[^A-Za-z 0-9 \.,\?""!@#\$%\^&\*\(\)-_=\+;:<>\/\\\|\}\{\[\]`~]*/g,""),$.isNumeric(a))return!0;var b=a.match(/^[\s()+-]*([0-9][\s()+-]*){7,20}(( x| ext)\d{1,5}){0,1}$/);return null!=b&&b.length>0},isValidURL:function(a){var b=a.match(/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{1,}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_@\!-]+))*$/);return null!=b&&b.length>0},isValidPassword:function(a){var b=a.match(/[0-9]/);return a.length>=4&&b},isNumeric:function(a,b){$.isNumeric(a);return b?(0^a)===Number(a):$.isNumeric(a)},isValidDate:function(b){return isNaN(b)||(b=parseInt(b)),a(b).isValid()}}}(b),g=function(a,b){var c={name:null,value:null,required:!1,unit:"",kind:"string",form:!1,editor:null,description:"",select:[]},d=function(a){a=a||{},this.raw=a,this.name=a.name||c.name,this.value=a.value||c.value,this.required=a.required||c.required,this.unit=a.unit||c.unit,this.kind=a.kind||c.kind,this.form=a.form||c.form,this.editor=a.editor||c.editor,this.description=a.description||c.description,this.select=a.select||c.select};return d.prototype.isValid=function(c){var d=a.trim(this.value);if(!this.required&&""==d)return!0;switch(this.kind){case"float":case"decimal":case"currency":return b.isNumeric(d);case"int":return b.isNumeric(d,!0);case"date":case"datetime":return b.isValidDate(d);case"string":case"select":return"phone"==this.editor?b.isValidPhone(d):"email"==this.editor?b.isValidEmail(d):"url"==this.editor?b.isValidURL(d):"number"==this.editor?b.isNumeric(d):""!=d;default:return!0}},d.prototype.isDirty=function(){return this.raw.value!=this.value},d.prototype.isEmpty=function(){return""==a.trim(this.value)},d}(a,f),h=function(a,b){b.fn.toJSONDate=function(){return this.format("YYYY-MM-DD[T]HH:mm:ss.000[Z]")},b.fn.roundTo=function(a,c,d){a=b.normalizeUnits(a),c=c||1;var e=function(a){switch(d){case"up":a=Math.ceil(a/c);break;case"down":a=Math.floor(a/c);break;default:a=Math.round(a/c)}return a*c};switch(a){case"year":this.year(e(this.year()));break;case"month":this.month(e(this.month()));break;case"week":this.weekday(e(this.weekday()));break;case"isoWeek":this.isoWeekday(e(this.isoWeekday()));break;case"day":this.day(e(this.day()));break;case"hour":this.hour(e(this.hour()));break;case"minute":this.minute(e(this.minute()));break;case"second":this.second(e(this.second()));break;default:this.millisecond(e(this.millisecond()))}return this};var c=15,d=9,e=17,f=function(a){a=a||{},this.roundType=a.roundType||"nearest",this.roundMinutes=a.roundMinutes||c,this.timeFormat24=a.timeFormat24?a.timeFormat24:!1,this._momentFormat=this.timeFormat24?"MMM D [at] H:mm":"MMM D [at] h:mm a",this.startOfDayHours=null!=a.startOfDayHours?startOfDayHours:d,this.endOfDayHours=null!=a.endOfDayHours?endOfDayHours:e,this.businessHours=a.businessHours||[],this.weekStart=a.weekStart||1};return f.prototype.parseDate=function(a){if(("string"==typeof a||a instanceof String)&&a.endsWith("+00:00")){var c=a.length;if(25==c)return b(a.substring(0,c-6));if(32==c)return b(a.substring(0,c-6).split(".")[0])}},f.prototype.getNow=function(){return b()},f.prototype.getFriendlyDuration=function(a){return a.humanize()},f.prototype.getFriendlyDateParts=function(a,c,d){return b.isMoment(a)||(a=b(a)),c=c||this.getNow(),a.calendar().replace("AM","am").replace("PM","pm").split(" at ")},f.prototype.getDateRanges=function(a,c,d,e){d&&!b.isMoment(d)&&(d=b(d)),e=e||{year:"year",years:"years",month:"month",months:"months",week:"week",weeks:"weeks",day:"day",days:"days",hour:"hour",hours:"hours"};for(var f=["years","months","weeks","days","hours"],g=[8760,720,168,24,1],h=null,i=null,j=null,k=0,l=-1,m=[],n=0;n<f.length;n++)if(i=g[n],h=f[n],a>=i&&a%i==0){l=n;break}if(d=d||this.getNow(),l>=0)for(var n=1;c>=n;n++)k=n*a,j=e[1==k?h.replace("s",""):h],m.push({option:h,hours:k,title:k/g[l]+" "+j,from:d.clone(),to:d.clone().add(k,"hours")});return m.filter(function(a){return global.dateHelper.isValidBusinessDate(a.to)})},f.prototype.getFriendlyFromTo=function(a,c,d,e,f,g){b.isMoment(a)||(a=b(a)),b.isMoment(c)||(c=b(c)),e=e||this.getNow();var h=f||" - ",i=this.getFriendlyDateParts(a,e,g),j=this.getFriendlyDateParts(c,e,g),k={dayDiff:a?a.clone().startOf("day").diff(c,"days"):-1,fromDate:a?i[0]:"No from date set",fromTime:d&&null!=a?i[1]:"",toDate:c?j[0]:"No to date set",toTime:d&&null!=c?j[1]:""};return k.fromText=k.fromDate,k.toText=k.toDate,d&&(k.fromTime&&(k.fromText+=" "+k.fromTime),k.toTime&&(k.toText+=" "+k.toTime)),k.text=0==k.dayDiff?d?k.fromText+h+k.toText:k.fromText:k.fromText+h+k.toText,k},f.prototype.getFriendlyFromToOld=function(a,c,d){var e=this.roundFromTime(a,d),f=this.roundToTime(c,d);return{from:e,to:f,daysBetween:f.clone().startOf("day").diff(e.clone().startOf("day"),"days"),duration:b.duration(e-f).humanize(),fromText:e.calendar().replace(" at "," "),toText:f.calendar().replace(" at "," ")}},f.prototype.makeStartDate=function(a,c,d,e,f,g){if(c=null!=c?c:!0,d=null!=d?d:!1,g=g||b(),c&&!d)a=this.roundTimeFrom(a);else{var h=a.isSame(g,"day"),i=this._makeStartOfBusinessDay(a);a=h?a.isBefore(i)?i:this.roundTimeFrom(a):i}return e&&a.isBefore(e)?e:a},f.prototype.makeEndDate=function(a,c,d,e,f,g){if(c=null!=c?c:!0,d=null!=d?d:!1,g=g||b(),c&&!d)a=this.roundTimeTo(a);else{var h=a.isSame(g,"day"),i=this._makeEndOfBusinessDay(a),j=this._makeEndOfDay(a);a=h?a.isBefore(i)?i:j:a.isAfter(i)?j:i}return f&&a.isAfter(f)?f:a},f.prototype.getFriendlyDateText=function(a,b,c,d){if(null==a)return"Not set";var e=this.getFriendlyDateParts(a,c,d);return b?e.join(" "):e[0]},f.prototype.addAverageDuration=function(a){return a.clone().add(1,"day")},f.prototype.roundTimeFrom=function(a){return this.roundMinutes<=1?a:this.roundTime(a,this.roundMinutes,this._typeToDirection(this.roundType,"from"))},f.prototype.roundTimeTo=function(a){return this.roundMinutes<=1?a:this.roundTime(a,this.roundMinutes,this._typeToDirection(this.roundType,"to"))},f.prototype.roundTime=function(a,d,e){var f=b.isMoment(a)?a:b(a);return f.seconds(0).milliseconds(0),f.roundTo("minute",d||c,e)},f.prototype.roundTimeUp=function(a,d){var e=b.isMoment(a)?a:b(a);return e.seconds(0).milliseconds(0),e.roundTo("minute",d||c,"up")},f.prototype.roundTimeDown=function(a,d){var e=b.isMoment(a)?a:b(a);return e.seconds(0).milliseconds(0),e.roundTo("minute",d||c,"down")},f.prototype._typeToDirection=function(a,b){switch(a){case"longer":switch(b){case"from":return"down";case"to":return"up"}break;case"shorter":switch(b){case"from":return"up";case"to":return"down"}}},f.prototype.isValidBusinessDate=function(c){var d=!1,e=this.businessHours;return e.length>0?a.each(this._getBusinessHours(c),function(a,e){var f=b(b.utc(b.duration(e.openTime,"minutes").asMilliseconds()).format("H:mm"),"H:mm"),g=b(b.utc(b.duration(e.closeTime,"minutes").asMilliseconds()).format("H:mm"),"H:mm"),h=b(c.clone().format("H:mm"),"H:mm");return d=h.isBetween(f,g)||h.isSame(f)||h.isSame(g),d?!1:void 0}):d=!0,d},f.prototype.getValidBusinessDate=function(a){var b=this,c=this.getNow(),d=0;for(a.isBefore(c)&&a.date(c.date());!this.isValidBusinessDate(a)||d>=10080;)a=a.add(b.roundMinutes,"minutes"),d+=b.roundMinutes;return a},f.prototype._getBusinessHours=function(a){var b=this.businessHours;return b.length>0?b.filter(function(b){return b.isoWeekday==a.isoWeekday()}):[]},f.prototype._makeStartOfBusinessDay=function(a){var c=a.clone().hour(this.startOfDayHours).minutes(0).seconds(0).milliseconds(0),d=this.businessHours;if(d.length>0){var e=this._getBusinessHours(a);if(e.length>0){var f=b(b.utc(b.duration(e[0].openTime,"minutes").asMilliseconds()).format("H:mm"),"H:mm");c.hour(f.hour()).minute(f.minute())}}return this.getValidBusinessDate(c)},f.prototype._makeEndOfBusinessDay=function(a){var c=a.clone().hour(this.endOfDayHours).minutes(0).seconds(0).milliseconds(0),d=this.businessHours;if(d.length>0){var e=this._getBusinessHours(a).sort(function(a,b){return a.closeTime<b.closeTime});if(e.length>0){var f=b(b.utc(b.duration(e[0].closeTime,"minutes").asMilliseconds()).format("H:mm"),"H:mm");c.hour(f.hour()).minute(f.minute())}}return this.getValidBusinessDate(c)},f.prototype._makeEndOfDay=function(a){return a.clone().hours(23).minutes(45).seconds(0).milliseconds(0)},f}(a,b),i=function(){String.prototype.pluralize=function(a,b){return"is"==this&&1!=a?"are":"this"==this?1==a?this:"these":this.endsWith("s")?(b=b||"es",1==a?this:this+b):this.endsWith("y")?(b=b||"ies",1==a?this:this.substr(0,this.length-1)+b):(b=b||"s",1==a?this:this+b)},String.prototype.capitalize=function(a){return(a?this.toLowerCase():this).replace(/(?:^|\s)\S/g,function(a){return a.toUpperCase()})},String.prototype.startsWith||(String.prototype.startsWith=function(a){return 0==this.indexOf(a)}),String.prototype.endsWith||(String.prototype.endsWith=function(a){return this.length<a.length?!1:this.lastIndexOf(a)==this.length-a.length}),String.prototype.truncate||(String.prototype.truncate=function(a){a=null!=a?a:25;var b=this.match(RegExp("^.{0,"+a+"}[S]*")),c=b[0].length;return b=b[0].replace(/\s$/,""),c<this.length&&(b+="&hellip;"),b}),String.prototype.isValidUrl||(String.prototype.isValidUrl=function(){var a=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return a.test(this)?!0:!1}),String.prototype.hashCode||(String.prototype.hashCode=function(){var a,b,c,d=0;if(0==this.length)return d;for(a=0,c=this.length;c>a;a++)b=this.charCodeAt(a),d=(d<<5)-d+b,d|=0;return d});var a={};a.latin_map={"Á":"A","Ă":"A","Ắ":"A","Ặ":"A","Ằ":"A","Ẳ":"A","Ẵ":"A","Ǎ":"A","Â":"A","Ấ":"A","Ậ":"A","Ầ":"A","Ẩ":"A","Ẫ":"A","Ä":"A","Ǟ":"A","Ȧ":"A","Ǡ":"A","Ạ":"A","Ȁ":"A","À":"A","Ả":"A","Ȃ":"A","Ā":"A","Ą":"A","Å":"A","Ǻ":"A","Ḁ":"A","Ⱥ":"A","Ã":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ḃ":"B","Ḅ":"B","Ɓ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ć":"C","Č":"C","Ç":"C","Ḉ":"C","Ĉ":"C","Ċ":"C","Ƈ":"C","Ȼ":"C","Ď":"D","Ḑ":"D","Ḓ":"D","Ḋ":"D","Ḍ":"D","Ɗ":"D","Ḏ":"D","ǲ":"D","ǅ":"D","Đ":"D","Ƌ":"D","Ǳ":"DZ","Ǆ":"DZ","É":"E","Ĕ":"E","Ě":"E","Ȩ":"E","Ḝ":"E","Ê":"E","Ế":"E","Ệ":"E","Ề":"E","Ể":"E","Ễ":"E","Ḙ":"E","Ë":"E","Ė":"E","Ẹ":"E","Ȅ":"E","È":"E","Ẻ":"E","Ȇ":"E","Ē":"E","Ḗ":"E","Ḕ":"E","Ę":"E","Ɇ":"E","Ẽ":"E","Ḛ":"E","Ꝫ":"ET","Ḟ":"F","Ƒ":"F","Ǵ":"G","Ğ":"G","Ǧ":"G","Ģ":"G","Ĝ":"G","Ġ":"G","Ɠ":"G","Ḡ":"G","Ǥ":"G","Ḫ":"H","Ȟ":"H","Ḩ":"H","Ĥ":"H","Ⱨ":"H","Ḧ":"H","Ḣ":"H","Ḥ":"H","Ħ":"H","Í":"I","Ĭ":"I","Ǐ":"I","Î":"I","Ï":"I","Ḯ":"I","İ":"I","Ị":"I","Ȉ":"I","Ì":"I","Ỉ":"I","Ȋ":"I","Ī":"I","Į":"I","Ɨ":"I","Ĩ":"I","Ḭ":"I","Ꝺ":"D","Ꝼ":"F","Ᵹ":"G","Ꞃ":"R","Ꞅ":"S","Ꞇ":"T","Ꝭ":"IS","Ĵ":"J","Ɉ":"J","Ḱ":"K","Ǩ":"K","Ķ":"K","Ⱪ":"K","Ꝃ":"K","Ḳ":"K","Ƙ":"K","Ḵ":"K","Ꝁ":"K","Ꝅ":"K","Ĺ":"L","Ƚ":"L","Ľ":"L","Ļ":"L","Ḽ":"L","Ḷ":"L","Ḹ":"L","Ⱡ":"L","Ꝉ":"L","Ḻ":"L","Ŀ":"L","Ɫ":"L","ǈ":"L","Ł":"L","Ǉ":"LJ","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ń":"N","Ň":"N","Ņ":"N","Ṋ":"N","Ṅ":"N","Ṇ":"N","Ǹ":"N","Ɲ":"N","Ṉ":"N","Ƞ":"N","ǋ":"N","Ñ":"N","Ǌ":"NJ","Ó":"O","Ŏ":"O","Ǒ":"O","Ô":"O","Ố":"O","Ộ":"O","Ồ":"O","Ổ":"O","Ỗ":"O","Ö":"O","Ȫ":"O","Ȯ":"O","Ȱ":"O","Ọ":"O","Ő":"O","Ȍ":"O","Ò":"O","Ỏ":"O","Ơ":"O","Ớ":"O","Ợ":"O","Ờ":"O","Ở":"O","Ỡ":"O","Ȏ":"O","Ꝋ":"O","Ꝍ":"O","Ō":"O","Ṓ":"O","Ṑ":"O","Ɵ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Õ":"O","Ṍ":"O","Ṏ":"O","Ȭ":"O","Ƣ":"OI","Ꝏ":"OO","Ɛ":"E","Ɔ":"O","Ȣ":"OU","Ṕ":"P","Ṗ":"P","Ꝓ":"P","Ƥ":"P","Ꝕ":"P","Ᵽ":"P","Ꝑ":"P","Ꝙ":"Q","Ꝗ":"Q","Ŕ":"R","Ř":"R","Ŗ":"R","Ṙ":"R","Ṛ":"R","Ṝ":"R","Ȑ":"R","Ȓ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꜿ":"C","Ǝ":"E","Ś":"S","Ṥ":"S","Š":"S","Ṧ":"S","Ş":"S","Ŝ":"S","Ș":"S","Ṡ":"S","Ṣ":"S","Ṩ":"S","Ť":"T","Ţ":"T","Ṱ":"T","Ț":"T","Ⱦ":"T","Ṫ":"T","Ṭ":"T","Ƭ":"T","Ṯ":"T","Ʈ":"T","Ŧ":"T","Ɐ":"A","Ꞁ":"L","Ɯ":"M","Ʌ":"V","Ꜩ":"TZ","Ú":"U","Ŭ":"U","Ǔ":"U","Û":"U","Ṷ":"U","Ü":"U","Ǘ":"U","Ǚ":"U","Ǜ":"U","Ǖ":"U","Ṳ":"U","Ụ":"U","Ű":"U","Ȕ":"U","Ù":"U","Ủ":"U","Ư":"U","Ứ":"U","Ự":"U","Ừ":"U","Ử":"U","Ữ":"U","Ȗ":"U","Ū":"U","Ṻ":"U","Ų":"U","Ů":"U","Ũ":"U","Ṹ":"U","Ṵ":"U","Ꝟ":"V","Ṿ":"V","Ʋ":"V","Ṽ":"V","Ꝡ":"VY","Ẃ":"W","Ŵ":"W","Ẅ":"W","Ẇ":"W","Ẉ":"W","Ẁ":"W","Ⱳ":"W","Ẍ":"X","Ẋ":"X","Ý":"Y","Ŷ":"Y","Ÿ":"Y","Ẏ":"Y","Ỵ":"Y","Ỳ":"Y","Ƴ":"Y","Ỷ":"Y","Ỿ":"Y","Ȳ":"Y","Ɏ":"Y","Ỹ":"Y","Ź":"Z","Ž":"Z","Ẑ":"Z","Ⱬ":"Z","Ż":"Z","Ẓ":"Z","Ȥ":"Z","Ẕ":"Z","Ƶ":"Z","Ĳ":"IJ","Œ":"OE","ᴀ":"A","ᴁ":"AE","ʙ":"B","ᴃ":"B","ᴄ":"C","ᴅ":"D","ᴇ":"E","ꜰ":"F","ɢ":"G","ʛ":"G","ʜ":"H","ɪ":"I","ʁ":"R","ᴊ":"J","ᴋ":"K","ʟ":"L","ᴌ":"L","ᴍ":"M","ɴ":"N","ᴏ":"O","ɶ":"OE","ᴐ":"O","ᴕ":"OU","ᴘ":"P","ʀ":"R","ᴎ":"N","ᴙ":"R","ꜱ":"S","ᴛ":"T","ⱻ":"E","ᴚ":"R","ᴜ":"U","ᴠ":"V","ᴡ":"W","ʏ":"Y","ᴢ":"Z","á":"a","ă":"a","ắ":"a","ặ":"a","ằ":"a","ẳ":"a","ẵ":"a","ǎ":"a","â":"a","ấ":"a","ậ":"a","ầ":"a","ẩ":"a","ẫ":"a","ä":"a","ǟ":"a","ȧ":"a","ǡ":"a","ạ":"a","ȁ":"a","à":"a","ả":"a","ȃ":"a","ā":"a","ą":"a","ᶏ":"a","ẚ":"a","å":"a","ǻ":"a","ḁ":"a","ⱥ":"a","ã":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ḃ":"b","ḅ":"b","ɓ":"b","ḇ":"b","ᵬ":"b","ᶀ":"b","ƀ":"b","ƃ":"b","ɵ":"o","ć":"c","č":"c","ç":"c","ḉ":"c","ĉ":"c","ɕ":"c","ċ":"c","ƈ":"c","ȼ":"c","ď":"d","ḑ":"d","ḓ":"d","ȡ":"d","ḋ":"d","ḍ":"d","ɗ":"d","ᶑ":"d","ḏ":"d","ᵭ":"d","ᶁ":"d","đ":"d","ɖ":"d","ƌ":"d","ı":"i","ȷ":"j","ɟ":"j","ʄ":"j","ǳ":"dz","ǆ":"dz","é":"e","ĕ":"e","ě":"e","ȩ":"e","ḝ":"e","ê":"e","ế":"e","ệ":"e","ề":"e","ể":"e","ễ":"e","ḙ":"e","ë":"e","ė":"e","ẹ":"e","ȅ":"e","è":"e","ẻ":"e","ȇ":"e","ē":"e","ḗ":"e","ḕ":"e","ⱸ":"e","ę":"e","ᶒ":"e","ɇ":"e","ẽ":"e","ḛ":"e","ꝫ":"et","ḟ":"f","ƒ":"f","ᵮ":"f","ᶂ":"f","ǵ":"g","ğ":"g","ǧ":"g","ģ":"g","ĝ":"g","ġ":"g","ɠ":"g","ḡ":"g","ᶃ":"g","ǥ":"g","ḫ":"h","ȟ":"h","ḩ":"h","ĥ":"h","ⱨ":"h","ḧ":"h","ḣ":"h","ḥ":"h","ɦ":"h","ẖ":"h","ħ":"h","ƕ":"hv","í":"i","ĭ":"i","ǐ":"i","î":"i","ï":"i","ḯ":"i","ị":"i","ȉ":"i","ì":"i","ỉ":"i","ȋ":"i","ī":"i","į":"i","ᶖ":"i","ɨ":"i","ĩ":"i","ḭ":"i","ꝺ":"d","ꝼ":"f","ᵹ":"g","ꞃ":"r","ꞅ":"s","ꞇ":"t","ꝭ":"is","ǰ":"j","ĵ":"j","ʝ":"j","ɉ":"j","ḱ":"k","ǩ":"k","ķ":"k","ⱪ":"k","ꝃ":"k","ḳ":"k","ƙ":"k","ḵ":"k","ᶄ":"k","ꝁ":"k","ꝅ":"k","ĺ":"l","ƚ":"l","ɬ":"l","ľ":"l","ļ":"l","ḽ":"l","ȴ":"l","ḷ":"l","ḹ":"l","ⱡ":"l","ꝉ":"l","ḻ":"l","ŀ":"l","ɫ":"l","ᶅ":"l","ɭ":"l","ł":"l","ǉ":"lj","ſ":"s","ẜ":"s","ẛ":"s","ẝ":"s","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ᵯ":"m","ᶆ":"m","ń":"n","ň":"n","ņ":"n","ṋ":"n","ȵ":"n","ṅ":"n","ṇ":"n","ǹ":"n","ɲ":"n","ṉ":"n","ƞ":"n","ᵰ":"n","ᶇ":"n","ɳ":"n","ñ":"n","ǌ":"nj","ó":"o","ŏ":"o","ǒ":"o","ô":"o","ố":"o","ộ":"o","ồ":"o","ổ":"o","ỗ":"o","ö":"o","ȫ":"o","ȯ":"o","ȱ":"o","ọ":"o","ő":"o","ȍ":"o","ò":"o","ỏ":"o","ơ":"o","ớ":"o","ợ":"o","ờ":"o","ở":"o","ỡ":"o","ȏ":"o","ꝋ":"o","ꝍ":"o","ⱺ":"o","ō":"o","ṓ":"o","ṑ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","õ":"o","ṍ":"o","ṏ":"o","ȭ":"o","ƣ":"oi","ꝏ":"oo","ɛ":"e","ᶓ":"e","ɔ":"o","ᶗ":"o","ȣ":"ou","ṕ":"p","ṗ":"p","ꝓ":"p","ƥ":"p","ᵱ":"p","ᶈ":"p","ꝕ":"p","ᵽ":"p","ꝑ":"p","ꝙ":"q","ʠ":"q","ɋ":"q","ꝗ":"q","ŕ":"r","ř":"r","ŗ":"r","ṙ":"r","ṛ":"r","ṝ":"r","ȑ":"r","ɾ":"r","ᵳ":"r","ȓ":"r","ṟ":"r","ɼ":"r","ᵲ":"r","ᶉ":"r","ɍ":"r","ɽ":"r","ↄ":"c","ꜿ":"c","ɘ":"e","ɿ":"r","ś":"s","ṥ":"s","š":"s","ṧ":"s","ş":"s","ŝ":"s","ș":"s","ṡ":"s","ṣ":"s","ṩ":"s","ʂ":"s","ᵴ":"s","ᶊ":"s","ȿ":"s","ɡ":"g","ᴑ":"o","ᴓ":"o","ᴝ":"u","ť":"t","ţ":"t","ṱ":"t","ț":"t","ȶ":"t","ẗ":"t","ⱦ":"t","ṫ":"t","ṭ":"t","ƭ":"t","ṯ":"t","ᵵ":"t","ƫ":"t","ʈ":"t","ŧ":"t","ᵺ":"th","ɐ":"a","ᴂ":"ae","ǝ":"e","ᵷ":"g","ɥ":"h","ʮ":"h","ʯ":"h","ᴉ":"i","ʞ":"k","ꞁ":"l","ɯ":"m","ɰ":"m","ᴔ":"oe","ɹ":"r","ɻ":"r","ɺ":"r","ⱹ":"r","ʇ":"t","ʌ":"v","ʍ":"w","ʎ":"y","ꜩ":"tz","ú":"u","ŭ":"u","ǔ":"u","û":"u","ṷ":"u","ü":"u","ǘ":"u","ǚ":"u","ǜ":"u","ǖ":"u","ṳ":"u","ụ":"u","ű":"u","ȕ":"u","ù":"u","ủ":"u","ư":"u","ứ":"u","ự":"u","ừ":"u","ử":"u","ữ":"u","ȗ":"u","ū":"u","ṻ":"u","ų":"u","ᶙ":"u","ů":"u","ũ":"u","ṹ":"u","ṵ":"u","ᵫ":"ue","ꝸ":"um","ⱴ":"v","ꝟ":"v","ṿ":"v","ʋ":"v","ᶌ":"v","ⱱ":"v","ṽ":"v","ꝡ":"vy","ẃ":"w","ŵ":"w","ẅ":"w","ẇ":"w","ẉ":"w","ẁ":"w","ⱳ":"w","ẘ":"w","ẍ":"x","ẋ":"x","ᶍ":"x","ý":"y","ŷ":"y","ÿ":"y","ẏ":"y","ỵ":"y","ỳ":"y","ƴ":"y","ỷ":"y","ỿ":"y","ȳ":"y","ẙ":"y","ɏ":"y","ỹ":"y","ź":"z","ž":"z","ẑ":"z","ʑ":"z","ⱬ":"z","ż":"z","ẓ":"z","ȥ":"z","ẕ":"z","ᵶ":"z","ᶎ":"z","ʐ":"z","ƶ":"z","ɀ":"z","ﬀ":"ff","ﬃ":"ffi","ﬄ":"ffl","ﬁ":"fi","ﬂ":"fl","ĳ":"ij","œ":"oe","ﬆ":"st","ₐ":"a","ₑ":"e","ᵢ":"i","ⱼ":"j","ₒ":"o","ᵣ":"r","ᵤ":"u","ᵥ":"v","ₓ":"x"},String.prototype.latinise=function(){return this.replace(/[^A-Za-z0-9\[\] ]/g,function(b){return a.latin_map[b]||b})},String.prototype.latinize=String.prototype.latinise,String.prototype.isLatin=function(){return this==this.latinise()},String.prototype.OnlyAlphaNumSpaceAndUnderscore=function(){return $.trim(this).toLowerCase().replace(/[\s-]+/g,"_").latinise().replace(/[\W]/g,"")},String.prototype.OnlyAlphaNumSpaceUnderscoreAndDot=function(){return $.trim(this).toLowerCase().replace(/[\s-]+/g,"_").latinise().replace(/[^a-z0-9_\.]/g,"")},String.prototype.NoWhiteSpaceInWord||(String.prototype.NoWhiteSpaceInWord=function(){return this.replace(/[\s]+/g,"")}),String.prototype.addLeadingZero||(String.prototype.addLeadingZero=function(a){var b=this.toString();return b.length<a?("0"+b).addLeadingZero(a):b}),String.prototype.lpad=function(a,b){for(var c=this;c.length<b;)c=a+c;return c},String.prototype.trimLeft||(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")}),String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(/\s+$/,"")}),Number.prototype.between||(Number.prototype.between=function(a,b){var c=Math.min(a,b),d=Math.max(a,b);return this>=c&&d>=this}),Array.prototype.joinOther||(Array.prototype.joinOther=function(a,b,c){if(this.length<2)return this.join(b);b=b||", ",c=c||"other",(!a||0>a)&&(a=1);for(var d=this.slice(0),e=d.join(b);d.length>1&&e.length>a;)d.pop(),e=d.join(b);var f=this.length-d.length;return f>0&&(e+=" +"+f+" "+c),e}),Array.prototype.joinAdvanced||(Array.prototype.joinAdvanced=function(a,b){var c=this.slice(0),d="";return 1===c.length?d=c[0]:2===c.length?d=c.join(b):c.length>2&&(d=c.slice(0,-1).join(a)+b+c.slice(-1)),d}),Array.prototype.find||(Array.prototype.find=function(a){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof a)throw new TypeError("predicate must be a function");for(var b,c=Object(this),d=c.length>>>0,e=arguments[1],f=0;d>f;f++)if(b=c[f],a.call(e,b,f,c))return b;return void 0}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(a,b){function c(a,b){return a===b||"number"==typeof a&&"number"==typeof b&&isNaN(a)&&isNaN(b)}if(null==this)throw new TypeError('"this" is null or not defined');var d=Object(this),e=d.length>>>0;if(0===e)return!1;for(var f=0|b,g=Math.max(f>=0?f:e-Math.abs(f),0);e>g;){if(c(d[g],a))return!0;g++}return!1}}),Object.values||(Object.values=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b}),CanvasRenderingContext2D.prototype.roundRect=function(a,b,c,d,e,f,g){var h={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0};if("undefined"==typeof g&&(g=!0),"object"==typeof e)for(var i in e)h[i]=e[i];this.beginPath(),this.moveTo(a+h.upperLeft,b),this.lineTo(a+c-h.upperRight,b),this.quadraticCurveTo(a+c,b,a+c,b+h.upperRight),this.lineTo(a+c,b+d-h.lowerRight),this.quadraticCurveTo(a+c,b+d,a+c-h.lowerRight,b+d),this.lineTo(a+h.lowerLeft,b+d),this.quadraticCurveTo(a,b+d,a,b+d-h.lowerLeft),this.lineTo(a,b+h.upperLeft),this.quadraticCurveTo(a,b,a+h.upperLeft,b),this.closePath(),g&&this.stroke(),f&&this.fill()}}(),j=function(){var a=localStorage.setItem,b=localStorage.getItem,c=localStorage.removeItem,d={};Storage.prototype.setItem=function(b,c){try{a.apply(this,[b,c])}catch(e){d[b]=String(c)}return!0},Storage.prototype.getItem=function(a){try{return b.apply(this,[a])}catch(c){return d.hasOwnProperty(a)?d[a]:void 0}return null},Storage.prototype.removeItem=function(a){try{c.apply(this,[a])}catch(b){delete d[a]}return!0;

}}(),k=function(a){var b={};return b.sortFields=function(b,c,d,e){var f=[],g=null,h=null;c=c.slice(),null!=d&&(c=c.filter(function(a){return a.form==d}));for(var i=0;i<c.length&&(g=c[i],h=b[g.name],f.push(a.extend({value:h},g)),!(null!=e&&f.length>=e));i++);return f},b.stringifyOrdered=function(a){if(keys=[],a)for(var b in a)keys.push(b);keys.sort();var b,c={};for(var d in keys)b=keys[d],c[b]=a[b];return JSON.stringify(c)},b.areEqual=function(a,c){return b.stringifyOrdered(a||{})==b.stringifyOrdered(c||{})},b.badgeify=function(a){return a>100?"99+":a>10?"10+":a>0?""+a:""},b.getLoginName=function(a,b){var c=/[\s-]*/gim,d=[];return a&&d.push(a.latinise().toLowerCase().replace(c,"")),b&&d.push(b.latinise().toLowerCase().replace(c,"")),d.join(".")},b.getUrlParam=function(a,b,c){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var d="[\\?&]"+a+"=([^&#]*)",e=new RegExp(d),f=e.exec(c||window.location.href);return f?decodeURIComponent(f[1].replace(/\+/g," ")):b},a.urlParam=b.getUrlParam,b.getParsedLines=function(b){if(b&&b.length>0){var c=b.split(/\s*([,;\r\n]+|\s\s)\s*/);return c.filter(function(b,c,d){return b.length>0&&b.indexOf(",")<0&&b.indexOf(";")<0&&a.trim(b).length>0&&d.indexOf(b)>=c}).map(function(b){return a.trim(b)})}return[]},b.getFriendlyFileName=function(a){return a.replace(/[^a-z0-9]/gi,"_").toLowerCase()},b.getFriendlyKind=function(a){var b=a;return"string"==a&&(b="single line text"),"text"==a&&(b="multi line text"),"select"==a&&(b="dropdown list"),"number"==a&&(b="numeric"),b},b.arrayToCSV=function(a,b){var c,d;c=new Blob([a],{type:"text/csv"}),window.navigator&&window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(c,b):(d=window.document.createElement("a"),d.download=b,d.href=window.URL.createObjectURL(c),d.style.display="none",window.document.body.appendChild(d),d.click())},b}(a),l=function(a,b,c,d,e,f,g,h,i){var j="cr_1802_professional_yearly_usd_500",k="yearly",l="attempt",m="trial",n=null,o=function(c,d){c=c||{},this.ds=c.ds||new b.ApiAnonymous({urlApi:d.urlApi,ajax:new b.ApiAjax}),this.firstName=c.firstName||"",this.lastName=c.lastName||"",this.company=c.company||"",this.timezone=c.timezone||"America/New_York",this.email=c.email||"",this.login=c.login||"",this.password=c.password||"",this.plan=c.plan||j,this.period=c.period||k,this.deviceKind=c.deviceKind||n,this.source=c.source||"",this.phone=c.phone||"",this.industry=c.industry||"",this.tags=c.tags||[],this.fields=[],this.inviteToken=c.inviteToken||"",this.selfserviceToken=c.selfserviceToken||"",this.onBeforeCreateAccount=c.onBeforeCreateAccount||function(){return a.Deferred().resolve()},this.onCreatedAccount=c.onCreatedAccount||function(){return a.Deferred().resolve()},this.onBeforeActivateAccount=c.onBeforeActivateAccount||function(){return a.Deferred().resolve()},this.onActivatedAccount=c.onActivatedAccount||function(){return a.Deferred().resolve()},this.onBeforeActivateInvite=c.onBeforeActivateInvite||function(){return a.Deferred().resolve()},this.onActivatedInvite=c.onActivatedInvite||function(){return a.Deferred().resolve()},this.onBeforeActivateSelfService=c.onBeforeActivateSelfService||function(){return a.Deferred().resolve()},this.onActivatedSelfService=c.onActivatedSelfService||function(){return a.Deferred().resolve()},this.onContactFields=c.onContactFields||function(){return a.Deferred().resolve()}};return o.prototype.validContactInfo=function(){return this.firstNameIsValid()&&this.lastNameIsValid()&&this.companyIsValid()&&this.emailIsValid()},o.prototype.validCredentials=function(){return this.loginIsValid()&&this.passwordIsValid()},o.prototype.firstNameIsValid=function(){var b=a.trim(this.firstName);return b.length>=2&&b.length<=25},o.prototype.lastNameIsValid=function(){var b=a.trim(this.lastName);return b.length>=2&&b.length<=25},o.prototype.companyIsValid=function(){var b=a.trim(this.company);return b.length>=3&&b.length<=46},o.prototype.companyExists=function(){var a=this.getGroupId();return this.ds.call("accountExists",{account:a}).then(function(a){return a.result})},o.prototype.emailIsValid=function(b){var c=a.trim(this.email),d=g.isValidEmail(c);return d&&1==b?!g.isFreeEmail(c):d},o.prototype.emailExists=function(){return this.emailIsValid()?this.ds.call("emailExists",{email:this.email}).then(function(a){return a.result}):a.Deferred().resolve(!1)},o.prototype.loginIsValid=function(){var a=this.login.NoWhiteSpaceInWord().OnlyAlphaNumSpaceUnderscoreAndDot();return a.length>=4&&a==this.login},o.prototype.loginExists=function(){return this.loginIsValid()?this.ds.call("loginExists",{login:this.login}).then(function(a){return a.result}):a.Deferred().resolve(!0)},o.prototype.checkInvited=function(){return this.ds.call("checkInvited",{email:this.email}).then(function(a){return a})},o.prototype.passwordIsValid=function(){return g.isValidPassword(a.trim(this.password))},o.prototype.phoneIsValid=function(){return g.isValidPhone(a.trim(this.phone))},o.prototype.parseFields=function(a){if(!a)return[];var b=[];a=a.filter(function(a){return a.form&&a.required});for(var c=0;c<a.length;c++)b.push(this._getField(a[c]));this.fields=b,this.onContactFields(b)},o.prototype.inviteIsValid=function(){var b=this;return""!=a.trim(this.inviteToken)?this.ds.call("checkInvite",{code:this.inviteToken}).then(function(a){return b.parseFields(a.customerFields),a.result}):a.Deferred().resolve(!1)},o.prototype.selfServiceIsValid=function(){var b=this;return""!=a.trim(this.selfserviceToken)?this.ds.call("checkSelfServiceKey",{key:this.selfserviceToken}).then(function(a){return b.parseFields(a.customerFields),a.result}):a.Deferred().resolve(!1)},o.prototype.getGroupId=function(){var b=a.trim(this.company);return b.replace(/[\.-\s]/g,"_").OnlyAlphaNumSpaceAndUnderscore()},o.prototype.getFullName=function(){var b=a.trim(this.firstName),c=a.trim(this.lastName);return a.trim(b+" "+c)},o.prototype.setFullName=function(b){var c=o.splitFirstLastName(a.trim(b));this.firstName=c.firstName,this.lastName=c.lastName,this.login=this.firstName||this.lastName?i.getLoginName(this.firstName,this.lastName):""},o.prototype._getField=function(a){return new d(a)},o.prototype.createAccount=function(){var b=this,c=this.onBeforeCreateAccount,d=this.onCreatedAccount;return c().then(function(){return b.ds.longCall("createAccount",{kind:m,period:a.trim(b.period),subscription:a.trim(b.plan),company:a.trim(b.company),groupId:b.getGroupId(),signupDevice:b.deviceKind,tags:b.tags},!0).then(function(a){return d(a)})})},o.prototype.activateAccount=function(c){var d=this,e=this.onBeforeActivateAccount,f=this.onActivatedAccount;return e().then(function(){return d.ds.longCall("activateAccount",{groupId:d.getGroupId(),name:d.getFullName(),login:a.trim(d.login),email:a.trim(d.email),password:a.trim(d.password),timezone:a.trim(d.timezone),load_sample:!1,owner_customer:!0,maintenance_customer:!0},!0).then(function(a){if(c){var e=new b.ApiUser({userId:d.login,userEmail:d.email,userToken:a.data.token});e.toStorage()}return f(a)})})},o.prototype.activateInvite=function(c){var d=this,e=this.onBeforeActivateInvite,f=this.onActivatedInvite;return e().then(function(){var e={name:d.getFullName(),code:d.inviteToken,login:a.trim(d.login),password:a.trim(d.password),timezone:a.trim(d.timezone)};return d.fields&&a.each(d.fields,function(a,b){e["fields__"+b.name]=b.value}),d.ds.longCall("activateInvite",e).then(function(a){if(c){var e=new b.ApiUser({userId:d.login,userToken:a.data.token});e.toStorage()}return f(a)})})},o.prototype.activateSelfService=function(c){var d=this,e=this.onBeforeActivateSelfService,f=this.onActivatedSelfService;return e().then(function(){var e={name:d.getFullName(),login:a.trim(d.login),password:a.trim(d.password),timezone:a.trim(d.timezone),email:a.trim(d.email),phone:a.trim(d.phone),key:d.selfserviceToken};return d.fields&&a.each(d.fields,function(a,b){e["fields__"+b.name]=b.value}),d.ds.longCall("createSelfServiceUser",e).then(function(a){if(c){var e=new b.ApiUser({userId:d.login,userToken:a.data.token});e.toStorage()}return f(a)})})},o.prototype.storeLead=function(b){return this.ds.call("storeLead",{firstName:a.trim(this.firstName),lastName:a.trim(this.lastName),email:a.trim(this.email),company:a.trim(this.company),phone:this.phone,tags:b||[]})},o.splitFirstLastName=function(b){var c=b.split(" ");return{firstName:a.trim(c.shift()),lastName:a.trim(c.join(" "))}},o.fromQueryString=function(b,c){var d=i.getUrlParam("name","").capitalize(),e=i.getUrlParam("email","").replace(" ","+"),f=i.getUrlParam("company",""),g=i.getUrlParam("firstName","").capitalize(),h=i.getUrlParam("lastName","").capitalize(),m=i.getUrlParam("login","").toLowerCase(),n=i.getUrlParam("source",l),p=i.getUrlParam("period",k),q=i.getUrlParam("plan",j),r=i.getUrlParam("timezone","America/New_York"),s=i.getUrlParam("code",""),t=i.getUrlParam("key",""),u=i.getUrlParam("phone","").replace(" ","+");if(0==g.length&&0==h.length&&d.length>0){var v=o.splitFirstLastName(d);g=v.firstName,h=v.lastName}return 0==m.length&&g.length>0&&h.length>0&&(m=i.getLoginName(g,h)),-1!=["starter","basic","professional","enterprise"].indexOf(q)&&(q=j),new o(a.extend({name:d,email:e,company:f,timezone:r,firstName:g,lastName:h,login:m,source:n,plan:q,period:p,phone:u,inviteToken:s,selfserviceToken:t},b),c)},o}(a,d,e,g,h,i,f,j,k)});